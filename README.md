# fuckReport
用来批量生成报告，需要自己设置好模板
# Generated by Gemini 本项目文档及核心代码逻辑由 AI 生成。在实际生产环境部署前，建议针对特定设备型号微调 random 数据范围，以确保报告的逻辑严密性。


# 网络安全运维报告自动化工具使用指南

本工具基于 Python 开发，旨在通过 Word 模板自动生成符合逻辑、数据真实的**日报、周报及月报**。它能够自动识别中国法定节假日，锁定最后一个工作日，并支持动态模拟设备运行指标。

---

## 一、 环境准备

在运行脚本前，请确保安装了以下依赖库：

```bash
pip install python-docx chinese_calendar

```

* **python-docx**: 用于处理 Word 文档的读写。
* **chinese_calendar**: 用于自动识别法定节假日（调休补班也能精准识别）。

---

## 二、 模式说明

在脚本的 `配置中心`，通过修改 `MODE` 变量切换报告生成类型：

| 模式变量 | 生成逻辑 | 适用场景 |
| --- | --- | --- |
| `WORKDAY_DAILY` | 每一个工作日生成 1 份报告 | 日常设备巡检记录 |
| `WEEKLY_FRIDAY` | 每周五生成 1 份报告 | 每周安全态势总结 |
| `MONTHLY_LAST_WORKDAY` | 每月最后一个工作日生成 1 份报告 | 月度运维总结报告 |

---

## 三、 占位符详解

在 Word 模板中，请使用 `{{变量名}}` 格式进行标注，脚本将自动替换为实际值。

### 1. 时间类占位符

| 占位符 | 说明 | 示例输出 |
| --- | --- | --- |
| `{{date}}` | 报告生成的完整日期 | 2024年12月25日 |
| `{{year}}` | 报告所属年份 | 2024 |
| `{{month}}` | 报告所属月份（两位数） | 12 |
| `{{month_index}}` | **相对月份期数** (从起始月算起的序号) | 2 |
| `{{week_index}}` | **周序号** (当前年的第几周) | 52 |
| `{{day}}` | 报告日期天数 | 25 |
| `{{weekday}}` | 报告所属星期 | 星期三 |

### 2. 统计与模拟类占位符

| 占位符 | 说明 | 示例输出 |
| --- | --- | --- |
| `{{workday_count}}` | **本月法定工作日总天数** | 22 |
| `{{random:X-Y}}` | **随机数生成器** | 见下方数据范围建议 |

---

## 四、 运维数据模拟范围建议

为了使报告中的随机数据看起来专业且真实，建议在模板中使用以下 `random` 范围：

### 1. 基础硬件指标

* **CPU 利用率**：`{{random:15.2-28.5}}%` (保持在30%以下代表系统健康)
* **内存利用率**：`{{random:40.5-55.8}}%` (安全设备通常内存占用较稳定)
* **设备温度**：`{{random:38-45}}℃` (模拟机房标准温升)
* **系统连续运行时间**：`{{random:720-744}}h` (针对月报)

### 2. 不同设备流量/性能指标

| 设备类型 | 监控项 | 建议占位符格式 | 逻辑含义 |
| --- | --- | --- | --- |
| **下一代防火墙** | 峰值吞吐 | `{{random:300-500}}Mbps` | 业务带宽占用，建议为总带宽的30%-50% |
| **下一代防火墙** | 并发连接数 | `{{random:12000-25000}}` | 模拟内网终端活跃度 |
| **全流量探针** | 日均流量 | `{{random:1.5-2.8}}TB` | 镜像流量分析，通常数据量巨大 |
| **日志审计系统** | 事件速率 | `{{random:400-800}}eps` | 每秒接收的系统日志条数 |
| **日志审计系统** | 存储占用 | `已使用{{random:65-75}}%` | 体现日志留存周期的动态变化 |


## 五、 使用流程

1. **准备模板**：创建 `月报模板.docx`，在其中插入上述占位符。
2. **设置起始**：修改脚本中的 `START_DATE`（这会决定 `{{month_index}}` 从哪个月开始算作第一期）。
3. **运行脚本**：脚本会自动在 `设备月报库` 文件夹下按日期顺序产出所有报告。


